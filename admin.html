<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Â· Budget Homes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=DM+Mono:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOKENS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root {
      --ink:          #0d0d0d;
      --ink-soft:     #444;
      --paper:        #f5f2eb;
      --paper-dark:   #edeade;
      --white:        #ffffff;
      --gold:         #b8942a;
      --gold-light:   #d4a93a;
      --gold-pale:    #faf4e6;
      --rule:         #d6cdb8;
      --rule-soft:    #e8e3d8;
      --success:      #2d6a4f;
      --success-bg:   #eaf7f0;
      --error:        #9b2226;
      --error-bg:     #fdf0f0;
      --warn:         #7d4e00;
      --warn-bg:      #fff8e6;
      --blue:         #1a56db;
      --blue-bg:      #eff6ff;
      --sidebar-w:    240px;
      --header-h:     56px;
      --radius:       2px;
      --mono:         'DM Mono', monospace;
      --serif:        'Cormorant Garamond', Georgia, serif;
      --transition:   0.18s ease;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: var(--mono);
      background: var(--paper);
      color: var(--ink);
      min-height: 100vh;
      font-size: 14px;
      line-height: 1.5;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCROLLBAR
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: var(--paper-dark); }
    ::-webkit-scrollbar-thumb { background: var(--rule); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--gold); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LOGIN SCREEN
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #loginScreen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      background:
        radial-gradient(ellipse at 20% 50%, rgba(184,148,42,0.06) 0%, transparent 60%),
        radial-gradient(ellipse at 80% 20%, rgba(184,148,42,0.04) 0%, transparent 50%),
        repeating-linear-gradient(0deg, transparent, transparent 39px, var(--rule-soft) 39px, var(--rule-soft) 40px),
        repeating-linear-gradient(90deg, transparent, transparent 39px, var(--rule-soft) 40px, var(--rule-soft) 41px),
        var(--paper);
    }

    .login-wrap {
      width: 100%;
      max-width: 400px;
    }

    .login-brand {
      text-align: center;
      margin-bottom: 2rem;
    }
    .login-brand-logo {
      font-family: var(--serif);
      font-size: 2.4rem;
      font-weight: 600;
      letter-spacing: 0.02em;
      line-height: 1;
    }
    .login-brand-logo span { color: var(--gold); }
    .login-brand-sub {
      font-size: 0.68rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: #aaa;
      margin-top: 0.3rem;
    }

    .login-card {
      background: var(--white);
      border: 1.5px solid var(--ink);
      box-shadow: 5px 5px 0 var(--ink);
      padding: 2.25rem 2rem;
      position: relative;
    }

    .login-card-label {
      position: absolute;
      top: -11px;
      left: 18px;
      background: var(--gold);
      color: var(--white);
      font-size: 0.58rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      padding: 2px 10px;
      font-weight: 500;
    }

    /* â”€â”€ Shared form elements â”€â”€ */
    .f-label {
      display: block;
      font-size: 0.65rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--ink-soft);
      margin-bottom: 0.35rem;
      margin-top: 1rem;
    }
    .f-label:first-child { margin-top: 0; }

    .f-input {
      width: 100%;
      border: 1.5px solid var(--rule);
      background: var(--paper);
      font-family: var(--mono);
      font-size: 0.88rem;
      padding: 0.6rem 0.85rem;
      outline: none;
      color: var(--ink);
      transition: border-color var(--transition), background var(--transition);
      border-radius: var(--radius);
      display: block;
    }
    .f-input:focus { border-color: var(--gold); background: var(--white); }
    .f-input.error { border-color: var(--error); }

    .f-error {
      font-size: 0.7rem;
      color: var(--error);
      min-height: 1.4em;
      margin-top: 0.4rem;
      letter-spacing: 0.03em;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-family: var(--mono);
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      padding: 0.65rem 1.4rem;
      border: none;
      cursor: pointer;
      transition: background var(--transition), box-shadow var(--transition), transform 0.1s, opacity var(--transition);
      border-radius: var(--radius);
      white-space: nowrap;
      font-weight: 500;
    }
    .btn:active:not(:disabled) { transform: scale(0.97); }
    .btn:disabled { opacity: 0.45; cursor: not-allowed; }

    .btn-primary { background: var(--ink); color: var(--white); width: 100%; margin-top: 1.25rem; padding: 0.75rem; }
    .btn-primary:hover:not(:disabled) { background: #222; }

    .btn-gold { background: var(--gold); color: var(--white); }
    .btn-gold:hover:not(:disabled) { background: var(--gold-light); box-shadow: 0 2px 12px rgba(184,148,42,0.35); }

    .btn-ghost {
      background: transparent;
      border: 1.5px solid var(--rule);
      color: var(--ink-soft);
    }
    .btn-ghost:hover:not(:disabled) { border-color: var(--ink); color: var(--ink); }

    .btn-danger { background: transparent; border: 1.5px solid var(--rule); color: var(--error); }
    .btn-danger:hover:not(:disabled) { background: var(--error-bg); border-color: var(--error); }

    .btn-text {
      background: transparent;
      border: none;
      color: #aaa;
      font-size: 0.68rem;
      padding: 0.3rem 0;
      text-decoration: underline;
      text-underline-offset: 3px;
      letter-spacing: 0.04em;
      text-transform: none;
    }
    .btn-text:hover { color: var(--gold); }

    /* â”€â”€ Forgot / Reset card â”€â”€ */
    #resetCard { display: none; }
    .card-title {
      font-family: var(--serif);
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 1.25rem;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LAYOUT â€” SIDEBAR + MAIN
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #appShell { display: none; min-height: 100vh; }
    #appShell.active { display: flex; flex-direction: column; }

    /* Top bar */
    .topbar {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: var(--header-h);
      background: var(--ink);
      display: flex;
      align-items: center;
      padding: 0 1.25rem;
      z-index: 200;
      gap: 1rem;
    }

    .topbar-brand {
      font-family: var(--serif);
      font-size: 1.35rem;
      font-weight: 600;
      color: var(--white);
      margin-right: auto;
    }
    .topbar-brand span { color: var(--gold-light); }

    .topbar-badge {
      font-size: 0.58rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: #666;
      display: none;
    }

    .topbar-btn {
      background: transparent;
      border: 1px solid #3a3a3a;
      color: #999;
      font-family: var(--mono);
      font-size: 0.65rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      padding: 0.35rem 0.9rem;
      cursor: pointer;
      transition: border-color var(--transition), color var(--transition);
      border-radius: var(--radius);
    }
    .topbar-btn:hover { border-color: var(--gold); color: var(--gold-light); }

    /* Sidebar */
    .sidebar {
      position: fixed;
      top: var(--header-h);
      left: 0;
      width: var(--sidebar-w);
      bottom: 0;
      background: var(--white);
      border-right: 1.5px solid var(--rule-soft);
      overflow-y: auto;
      z-index: 100;
      padding: 1.5rem 0;
    }

    .nav-group-label {
      font-size: 0.58rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: #bbb;
      padding: 0.5rem 1.25rem 0.3rem;
      margin-top: 0.75rem;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 0.65rem;
      padding: 0.65rem 1.25rem;
      font-size: 0.78rem;
      color: var(--ink-soft);
      cursor: pointer;
      transition: background var(--transition), color var(--transition);
      border-left: 3px solid transparent;
      letter-spacing: 0.02em;
    }
    .nav-item:hover { background: var(--paper); color: var(--ink); }
    .nav-item.active { background: var(--gold-pale); color: var(--gold); border-left-color: var(--gold); font-weight: 500; }
    .nav-item svg { flex-shrink: 0; opacity: 0.7; }
    .nav-item.active svg { opacity: 1; }

    .nav-divider { height: 1px; background: var(--rule-soft); margin: 0.75rem 1rem; }

    /* Main content */
    .main-content {
      margin-left: var(--sidebar-w);
      margin-top: var(--header-h);
      padding: 2rem 2.5rem;
      min-height: calc(100vh - var(--header-h));
      max-width: 960px;
    }

    /* â”€â”€ Page header â”€â”€ */
    .page-header { margin-bottom: 2rem; }
    .page-header h1 {
      font-family: var(--serif);
      font-size: 2rem;
      font-weight: 400;
      font-style: italic;
      color: var(--ink);
      line-height: 1.15;
    }
    .page-header p {
      font-size: 0.75rem;
      color: #888;
      margin-top: 0.3rem;
      letter-spacing: 0.04em;
    }

    /* â”€â”€ Section rule â”€â”€ */
    .section-rule {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin: 2rem 0 1.25rem;
    }
    .section-rule span {
      font-size: 0.6rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--gold);
      white-space: nowrap;
      font-weight: 500;
    }
    .section-rule::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--rule-soft);
    }

    /* â”€â”€ Alert boxes â”€â”€ */
    .alert {
      padding: 0.75rem 1rem;
      border-radius: var(--radius);
      font-size: 0.75rem;
      line-height: 1.6;
      margin-bottom: 1rem;
      border-left: 3px solid;
    }
    .alert-warn  { background: var(--warn-bg);    color: var(--warn);    border-color: #d4850a; }
    .alert-ok    { background: var(--success-bg); color: var(--success); border-color: var(--success); }
    .alert-error { background: var(--error-bg);   color: var(--error);   border-color: var(--error); }
    .alert-info  { background: var(--blue-bg);    color: var(--blue);    border-color: var(--blue); }

    /* â”€â”€ Cards / panels â”€â”€ */
    .panel {
      background: var(--white);
      border: 1.5px solid var(--rule-soft);
      padding: 1.5rem;
      margin-bottom: 1.25rem;
      border-radius: var(--radius);
    }

    .panel-title {
      font-size: 0.65rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: 1rem;
      font-weight: 500;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE: DASHBOARD
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .stat-card {
      background: var(--white);
      border: 1.5px solid var(--rule-soft);
      padding: 1.25rem 1.5rem;
      border-radius: var(--radius);
      position: relative;
      overflow: hidden;
    }
    .stat-card::after {
      content: '';
      position: absolute;
      bottom: 0; left: 0; right: 0;
      height: 3px;
      background: var(--gold);
      transform: scaleX(0);
      transition: transform 0.4s ease;
      transform-origin: left;
    }
    .stat-card:hover::after { transform: scaleX(1); }

    .stat-label { font-size: 0.65rem; letter-spacing: 0.12em; text-transform: uppercase; color: #aaa; margin-bottom: 0.4rem; }
    .stat-value { font-family: var(--serif); font-size: 2rem; font-weight: 600; line-height: 1; color: var(--ink); }
    .stat-value small { font-size: 0.9rem; font-family: var(--mono); color: #888; margin-left: 2px; }
    .stat-unit  { font-size: 0.68rem; color: #aaa; margin-top: 0.25rem; }

    .activity-list { list-style: none; }
    .activity-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.65rem 0;
      border-bottom: 1px solid var(--rule-soft);
      font-size: 0.75rem;
    }
    .activity-item:last-child { border-bottom: none; }
    .activity-dot { width: 7px; height: 7px; border-radius: 50%; background: var(--rule); flex-shrink: 0; }
    .activity-dot.ok { background: var(--success); }
    .activity-dot.warn { background: #d4850a; }
    .activity-time { color: #aaa; font-size: 0.68rem; margin-left: auto; white-space: nowrap; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE: PRICES
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .price-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .price-card {
      background: var(--white);
      border: 1.5px solid var(--rule-soft);
      padding: 1.25rem;
      border-radius: var(--radius);
      position: relative;
      transition: border-color var(--transition), box-shadow var(--transition);
    }
    .price-card:hover { border-color: var(--gold); box-shadow: 3px 3px 0 var(--gold-pale); }
    .price-card.pg { border-color: rgba(184,148,42,0.4); background: var(--gold-pale); }

    .price-card-badge {
      position: absolute;
      top: -1px; left: 1rem;
      transform: translateY(-50%);
      background: var(--ink);
      color: var(--white);
      font-size: 0.58rem;
      letter-spacing: 0.14em;
      padding: 2px 8px;
      text-transform: uppercase;
    }
    .price-card.pg .price-card-badge { background: var(--gold); }

    .price-card-name {
      font-family: var(--serif);
      font-size: 1rem;
      font-weight: 600;
      margin-top: 0.5rem;
      margin-bottom: 0.15rem;
    }
    .price-card-type { font-size: 0.62rem; color: #999; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.85rem; }

    .price-input-row {
      display: flex;
      align-items: stretch;
      border: 1.5px solid var(--ink);
      background: var(--paper);
      border-radius: var(--radius);
      overflow: hidden;
      transition: border-color var(--transition);
    }
    .price-input-row:focus-within { border-color: var(--gold); background: var(--white); }

    .price-sym {
      display: flex;
      align-items: center;
      padding: 0 0.6rem;
      font-family: var(--serif);
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--gold);
      border-right: 1px solid var(--rule-soft);
      user-select: none;
      background: transparent;
    }

    .price-num {
      flex: 1;
      border: none;
      background: transparent;
      font-family: var(--mono);
      font-size: 1.05rem;
      font-weight: 500;
      padding: 0.5rem 0.6rem;
      outline: none;
      color: var(--ink);
      -moz-appearance: textfield;
      min-width: 0;
    }
    .price-num::-webkit-inner-spin-button,
    .price-num::-webkit-outer-spin-button { -webkit-appearance: none; }

    .price-suffix {
      display: flex;
      align-items: center;
      padding: 0 0.6rem;
      font-size: 0.6rem;
      color: #aaa;
      border-left: 1px solid var(--rule-soft);
      user-select: none;
      white-space: nowrap;
    }

    /* â”€â”€ Action bar â”€â”€ */
    .action-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      padding: 1rem 1.25rem;
      background: var(--white);
      border: 1.5px solid var(--rule-soft);
      border-radius: var(--radius);
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    .action-bar-left { display: flex; align-items: center; gap: 0.75rem; }
    .action-bar-right { display: flex; align-items: center; gap: 0.75rem; }

    .status-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.68rem;
      color: #888;
      letter-spacing: 0.04em;
    }
    .status-dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: var(--rule);
      flex-shrink: 0;
      transition: background 0.3s;
    }
    .status-dot.saved { background: var(--success); }
    .status-dot.dirty { background: #d4850a; }

    /* â”€â”€ Starting from panel â”€â”€ */
    .starting-from-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE: GALLERY
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .gallery-card {
      border: 1.5px solid var(--rule-soft);
      background: var(--white);
      border-radius: var(--radius);
      overflow: hidden;
      position: relative;
      transition: border-color var(--transition), box-shadow var(--transition);
      cursor: pointer;
    }
    .gallery-card:hover { border-color: var(--gold); box-shadow: 3px 3px 0 var(--gold-pale); }

    .gallery-card-num {
      position: absolute;
      top: 8px; left: 8px;
      background: rgba(0,0,0,0.75);
      color: var(--white);
      font-size: 0.58rem;
      letter-spacing: 0.12em;
      padding: 2px 8px;
      z-index: 2;
      border-radius: 2px;
    }

    .gallery-card-remove {
      position: absolute;
      top: 8px; right: 8px;
      background: var(--error);
      color: var(--white);
      border: none;
      width: 24px; height: 24px;
      font-size: 0.8rem;
      cursor: pointer;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 2px;
      opacity: 0;
      transition: opacity var(--transition);
    }
    .gallery-card:hover .gallery-card-remove { opacity: 1; }

    .gallery-thumb {
      width: 100%;
      aspect-ratio: 4/3;
      overflow: hidden;
      background: var(--paper-dark);
      position: relative;
    }
    .gallery-thumb img {
      width: 100%; height: 100%;
      object-fit: cover;
      display: block;
      transition: transform 0.3s ease;
    }
    .gallery-card:hover .gallery-thumb img { transform: scale(1.04); }

    .gallery-thumb-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.42);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity var(--transition);
      font-size: 0.7rem;
      letter-spacing: 0.1em;
      color: var(--white);
      text-transform: uppercase;
    }
    .gallery-card:hover .gallery-thumb-overlay { opacity: 1; }

    .gallery-card-body {
      padding: 0.65rem 0.75rem;
    }
    .gallery-alt-label {
      font-size: 0.58rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: #bbb;
      display: block;
      margin-bottom: 0.25rem;
    }
    .gallery-alt-input {
      width: 100%;
      border: 1px solid var(--rule-soft);
      background: var(--paper);
      font-family: var(--mono);
      font-size: 0.72rem;
      padding: 0.35rem 0.5rem;
      outline: none;
      color: var(--ink);
      transition: border-color var(--transition);
      border-radius: var(--radius);
    }
    .gallery-alt-input:focus { border-color: var(--gold); background: var(--white); }

    .gallery-add-card {
      border: 2px dashed var(--rule);
      background: transparent;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      aspect-ratio: 4/3;
      cursor: pointer;
      color: #bbb;
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.06em;
      gap: 0.5rem;
      transition: all var(--transition);
      min-height: 140px;
    }
    .gallery-add-card:hover { border-color: var(--gold); color: var(--gold); background: var(--gold-pale); }

    /* â”€â”€ Drag hint â”€â”€ */
    .drag-hint {
      font-size: 0.65rem;
      color: #bbb;
      letter-spacing: 0.06em;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    /* â”€â”€ drag-over style â”€â”€ */
    .gallery-card.drag-over { outline: 2px solid var(--gold); outline-offset: 2px; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE: PUBLISH
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .github-panel {
      background: var(--white);
      border: 1.5px solid var(--rule-soft);
      border-radius: var(--radius);
      overflow: hidden;
      margin-bottom: 1.25rem;
    }
    .github-panel-head {
      background: var(--ink);
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .github-panel-head-title {
      font-family: var(--serif);
      font-size: 1.05rem;
      font-weight: 600;
      color: var(--white);
    }
    .github-panel-head-sub {
      font-size: 0.68rem;
      color: #888;
      margin-left: auto;
    }
    .github-panel-body { padding: 1.5rem; }

    .github-fields {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
    }
    .github-field { display: flex; flex-direction: column; gap: 0.3rem; }
    .github-field.full { grid-column: 1 / -1; }
    .github-field .f-label { margin-top: 0; }

    .token-wrap { position: relative; }
    .token-toggle {
      position: absolute;
      right: 0.6rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
      color: #aaa;
      padding: 2px;
      font-size: 0.7rem;
    }
    .token-toggle:hover { color: var(--gold); }
    .token-wrap .f-input { padding-right: 2.5rem; }

    .connection-test {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    .connection-result {
      font-size: 0.72rem;
      letter-spacing: 0.03em;
    }
    .connection-result.ok    { color: var(--success); }
    .connection-result.error { color: var(--error); }

    /* â”€â”€ Publish action panel â”€â”€ */
    .publish-panel {
      background: var(--ink);
      border-radius: var(--radius);
      padding: 1.75rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.5rem;
      flex-wrap: wrap;
      position: relative;
      overflow: hidden;
    }
    .publish-panel::before {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        -55deg,
        transparent, transparent 15px,
        rgba(255,255,255,0.015) 15px, rgba(255,255,255,0.015) 30px
      );
    }

    .publish-info { position: relative; z-index: 1; }
    .publish-title { font-family: var(--serif); font-size: 1.3rem; font-weight: 600; color: var(--white); margin-bottom: 0.25rem; }
    .publish-sub   { font-size: 0.7rem; color: #666; letter-spacing: 0.04em; }
    .publish-sub strong { color: var(--gold-light); }

    .btn-publish {
      position: relative;
      z-index: 1;
      background: var(--gold);
      color: var(--white);
      border: none;
      font-family: var(--mono);
      font-size: 0.78rem;
      font-weight: 500;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      padding: 0.9rem 2.25rem;
      cursor: pointer;
      transition: background var(--transition), box-shadow var(--transition), transform 0.1s;
      border-radius: var(--radius);
      white-space: nowrap;
      min-width: 200px;
    }
    .btn-publish:hover:not(:disabled) { background: var(--gold-light); box-shadow: 0 0 24px rgba(184,148,42,0.45); }
    .btn-publish:active:not(:disabled) { transform: scale(0.97); }
    .btn-publish:disabled { opacity: 0.4; cursor: not-allowed; }

    .publish-result {
      font-size: 0.72rem;
      margin-top: 0.6rem;
      letter-spacing: 0.04em;
      min-height: 1.2em;
    }
    .publish-result.ok    { color: #6fcf97; }
    .publish-result.error { color: #eb5757; }
    .publish-result.info  { color: #a0aec0; }

    /* â”€â”€ Publish log â”€â”€ */
    .publish-log {
      background: #111;
      border-radius: var(--radius);
      padding: 1rem 1.25rem;
      margin-top: 1.25rem;
      font-size: 0.72rem;
      color: #6fcf97;
      font-family: var(--mono);
      line-height: 1.8;
      max-height: 200px;
      overflow-y: auto;
      display: none;
    }
    .publish-log.active { display: block; }
    .log-line { display: block; }
    .log-line.err { color: #eb5757; }
    .log-line.dim { color: #555; }
    .log-line.ok  { color: #6fcf97; }

    .spinner {
      display: inline-block;
      width: 11px; height: 11px;
      border: 2px solid rgba(255,255,255,0.2);
      border-top-color: currentColor;
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
      vertical-align: middle;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE: SETTINGS (Password)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .settings-section { max-width: 480px; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODALS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 900;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
      backdrop-filter: blur(3px);
    }
    .modal-backdrop.open { display: flex; }

    .modal {
      background: var(--white);
      border: 1.5px solid var(--ink);
      box-shadow: 6px 6px 0 var(--ink);
      padding: 2rem;
      width: 100%;
      max-width: 460px;
      border-radius: var(--radius);
      animation: modalIn 0.2s cubic-bezier(0.34,1.56,0.64,1);
    }
    .modal.wide { max-width: 540px; }
    @keyframes modalIn {
      from { opacity: 0; transform: translateY(16px) scale(0.97); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }

    .modal-title {
      font-family: var(--serif);
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 1.25rem;
    }
    .modal-actions {
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
      margin-top: 1.5rem;
    }

    /* â”€â”€ Tabs (for photo edit modal) â”€â”€ */
    .tabs-nav {
      display: flex;
      border-bottom: 1.5px solid var(--rule-soft);
      margin-bottom: 1.25rem;
      gap: 0;
    }
    .tab-btn {
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      padding: 0.5rem 1.1rem;
      border: none;
      background: transparent;
      cursor: pointer;
      color: #aaa;
      border-bottom: 2px solid transparent;
      margin-bottom: -1.5px;
      transition: color var(--transition), border-color var(--transition);
    }
    .tab-btn.active { color: var(--gold); border-bottom-color: var(--gold); }
    .tab-pane { display: none; }
    .tab-pane.active { display: block; }

    .drop-zone {
      border: 2px dashed var(--rule);
      background: var(--paper);
      padding: 2rem 1rem;
      text-align: center;
      cursor: pointer;
      transition: all var(--transition);
      position: relative;
      border-radius: var(--radius);
    }
    .drop-zone:hover, .drop-zone.drag-over { border-color: var(--gold); background: var(--gold-pale); }
    .drop-zone input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
      width: 100%;
      height: 100%;
    }
    .drop-zone-text { font-size: 0.75rem; color: #888; line-height: 1.7; pointer-events: none; }
    .drop-zone-text strong { display: block; font-size: 0.88rem; color: var(--ink); margin-bottom: 0.2rem; }

    .img-preview {
      width: 100%;
      max-height: 180px;
      object-fit: cover;
      display: none;
      margin-top: 0.75rem;
      border: 1.5px solid var(--rule-soft);
      border-radius: var(--radius);
    }
    .img-preview.show { display: block; }

    /* â”€â”€ Recovery key display â”€â”€ */
    .recovery-box {
      background: var(--ink);
      color: var(--gold-light);
      font-family: var(--mono);
      font-size: 1.2rem;
      font-weight: 500;
      letter-spacing: 0.2em;
      text-align: center;
      padding: 1.1rem;
      border: 2px solid var(--gold);
      margin: 1rem 0 0.75rem;
      border-radius: var(--radius);
      user-select: all;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOAST
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #toast {
      position: fixed;
      bottom: 1.75rem;
      left: 50%;
      transform: translateX(-50%) translateY(80px);
      background: var(--ink);
      color: var(--white);
      font-size: 0.75rem;
      letter-spacing: 0.06em;
      padding: 0.75rem 1.5rem;
      border-left: 3px solid var(--gold);
      box-shadow: 4px 4px 0 var(--gold);
      transition: transform 0.35s cubic-bezier(0.34,1.56,0.64,1);
      z-index: 999;
      border-radius: var(--radius);
      white-space: nowrap;
    }
    #toast.show { transform: translateX(-50%) translateY(0); }
    #toast.ok   { border-color: var(--success); }
    #toast.err  { border-color: var(--error); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HAMBURGER (mobile)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .sidebar-toggle {
      display: none;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 6px;
      flex-direction: column;
      gap: 5px;
      margin-right: 0.5rem;
    }
    .sidebar-toggle span {
      display: block;
      width: 20px;
      height: 2px;
      background: var(--white);
      transition: all 0.2s;
    }

    /* â”€â”€ Hidden pages â”€â”€ */
    .page { display: none; }
    .page.active { display: block; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESPONSIVE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    @media (max-width: 768px) {
      :root { --sidebar-w: 0px; }

      .sidebar {
        transform: translateX(-240px);
        width: 240px;
        transition: transform 0.25s ease;
        box-shadow: none;
      }
      .sidebar.open { transform: translateX(0); box-shadow: 4px 0 20px rgba(0,0,0,0.12); }

      .main-content { margin-left: 0; padding: 1.5rem 1rem; }
      .sidebar-toggle { display: flex; }
      .topbar-badge { display: none; }
      .github-fields { grid-template-columns: 1fr; }
      .github-field.full { grid-column: 1; }
      .action-bar { flex-direction: column; align-items: stretch; }
      .action-bar-right { flex-wrap: wrap; }
      .publish-panel { flex-direction: column; }
      .btn-publish { width: 100%; }
      .price-grid { grid-template-columns: 1fr 1fr; }
      .gallery-grid { grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 420px) {
      .price-grid { grid-template-columns: 1fr; }
      .gallery-grid { grid-template-columns: 1fr 1fr; }
      .stats-grid { grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  LOGIN SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="loginScreen">
  <div class="login-wrap">
    <div class="login-brand">
      <div class="login-brand-logo">Budget <span>Homes</span></div>
      <div class="login-brand-sub">Admin Panel</div>
    </div>

    <!-- Login card -->
    <div class="login-card" id="loginCard">
      <div class="login-card-label">Secure Access</div>
      <label class="f-label" for="pwInput">Password</label>
      <input class="f-input" type="password" id="pwInput" placeholder="Enter admin password" autocomplete="current-password" />
      <div class="f-error" id="loginErr"></div>
      <button class="btn btn-primary" id="loginBtn">Unlock Panel â†’</button>
      <div style="text-align:center;margin-top:0.75rem;">
        <button class="btn btn-text" id="forgotBtn">Forgot password?</button>
      </div>
    </div>

    <!-- Reset password card -->
    <div class="login-card" id="resetCard">
      <div class="login-card-label">Reset Password</div>
      <p style="font-size:0.72rem;color:#888;line-height:1.7;margin-bottom:1rem;">Enter your recovery key to set a new password.</p>
      <label class="f-label" for="recoveryInput">Recovery Key</label>
      <input class="f-input" type="text" id="recoveryInput" placeholder="XXXX-XXXX-XXXX" autocomplete="off" style="letter-spacing:0.12em;" />
      <label class="f-label" for="newPwReset">New Password</label>
      <input class="f-input" type="password" id="newPwReset" placeholder="Min 6 characters" />
      <label class="f-label" for="confirmPwReset">Confirm Password</label>
      <input class="f-input" type="password" id="confirmPwReset" placeholder="Re-enter password" />
      <div class="f-error" id="resetErr"></div>
      <button class="btn btn-primary" id="doResetBtn">Set New Password â†’</button>
      <div style="text-align:center;margin-top:0.75rem;">
        <button class="btn btn-text" id="backLoginBtn">â† Back to login</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  APP SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="appShell">

  <!-- Top bar -->
  <header class="topbar">
    <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
      <span></span><span></span><span></span>
    </button>
    <div class="topbar-brand">Budget <span>Homes</span></div>
    <span class="topbar-badge" id="topbarBadge"></span>
    <button class="topbar-btn" id="changePwTopBtn">ğŸ”‘ Password</button>
    <button class="topbar-btn" id="logoutBtn">Log out</button>
  </header>

  <!-- Sidebar -->
  <nav class="sidebar" id="sidebar">
    <div class="nav-group-label">Main</div>
    <div class="nav-item active" data-page="dashboard">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
      Dashboard
    </div>
    <div class="nav-item" data-page="prices">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
      Prices
    </div>
    <div class="nav-item" data-page="gallery">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
      Gallery
    </div>
    <div class="nav-divider"></div>
    <div class="nav-group-label">Deploy</div>
    <div class="nav-item" data-page="publish">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><polyline points="16 16 12 12 8 16"/><line x1="12" y1="12" x2="12" y2="21"/><path d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"/></svg>
      Publish
    </div>
    <div class="nav-divider"></div>
    <div class="nav-group-label">Account</div>
    <div class="nav-item" data-page="settings">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
      Settings
    </div>
  </nav>

  <!-- Main content area -->
  <main class="main-content">

    <!-- â”€â”€ DASHBOARD â”€â”€ -->
    <div class="page active" id="page-dashboard">
      <div class="page-header">
        <h1>Dashboard</h1>
        <p>Overview of Budget Homes â€” Edappally, Kochi</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">Lowest Rate</div>
          <div class="stat-value" id="dash-lowest">â‚¹<span>â€”</span></div>
          <div class="stat-unit">per night</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">PG Rate</div>
          <div class="stat-value" id="dash-pg">â‚¹<span>â€”</span></div>
          <div class="stat-unit">per month</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Gallery Photos</div>
          <div class="stat-value" id="dash-photos"><span>â€”</span></div>
          <div class="stat-unit">photos in gallery</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Last Published</div>
          <div class="stat-value" id="dash-publish" style="font-size:1rem;margin-top:0.25rem;">â€”</div>
          <div class="stat-unit">via GitHub</div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Recent Activity</div>
        <ul class="activity-list" id="activityList">
          <li class="activity-item">
            <span class="activity-dot"></span>
            <span>No activity yet â€” make your first change</span>
          </li>
        </ul>
      </div>

      <div class="alert alert-info">
        <strong>How it works:</strong> Update prices or gallery photos, then go to <strong>Publish</strong> to push changes directly to GitHub. Vercel auto-deploys in ~15 seconds and every device worldwide sees the update instantly.
      </div>
    </div>

    <!-- â”€â”€ PRICES â”€â”€ -->
    <div class="page" id="page-prices">
      <div class="page-header">
        <h1>Room Prices</h1>
        <p>Set nightly rates for all 5 units and monthly PG rate</p>
      </div>

      <div class="action-bar">
        <div class="action-bar-left">
          <span class="status-pill">
            <span class="status-dot" id="priceStatusDot"></span>
            <span id="priceStatusText">No unsaved changes</span>
          </span>
        </div>
        <div class="action-bar-right">
          <button class="btn btn-ghost" id="priceResetBtn">Reset Defaults</button>
          <button class="btn btn-gold" id="priceSaveBtn">âœ¦ Save Prices</button>
        </div>
      </div>

      <div class="section-rule"><span>Nightly Rates</span></div>
      <div class="price-grid" id="nightlyGrid"></div>

      <div class="section-rule"><span>Paying Guest (Monthly)</span></div>
      <div class="price-grid" id="pgGrid"></div>

      <div class="section-rule"><span>Starting From â€” Website Display</span></div>
      <div class="panel">
        <div class="panel-title">Hero &amp; Booking Section</div>
        <p style="font-size:0.72rem;color:#888;margin-bottom:1rem;line-height:1.6;">This price appears in the hero tagline and "Book Directly" section. Usually your lowest nightly rate.</p>
        <div class="starting-from-row">
          <div class="price-input-row" style="max-width:220px;">
            <span class="price-sym">â‚¹</span>
            <input class="price-num" type="number" id="startingFrom" min="100" step="50" />
            <span class="price-suffix">/ night Â· from</span>
          </div>
          <span style="font-size:0.72rem;color:#aaa;">Shown as: <strong id="startingFromPreview" style="color:var(--gold);"></strong></span>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Admin Notes (private)</div>
        <textarea id="adminNotes" class="f-input" style="min-height:80px;resize:vertical;" placeholder="e.g. Peak season rates active Dec 20 â€“ Jan 5â€¦"></textarea>
      </div>
    </div>

    <!-- â”€â”€ GALLERY â”€â”€ -->
    <div class="page" id="page-gallery">
      <div class="page-header">
        <h1>Gallery Photos</h1>
        <p>Manage photos shown in the gallery section â€” click to edit, drag to reorder</p>
      </div>

      <div class="action-bar">
        <div class="action-bar-left">
          <span class="status-pill">
            <span class="status-dot" id="galleryStatusDot"></span>
            <span id="galleryStatusText">No unsaved changes</span>
          </span>
        </div>
        <div class="action-bar-right">
          <button class="btn btn-ghost" id="galleryResetBtn">Reset Original</button>
          <button class="btn btn-gold" id="gallerySaveBtn">âœ¦ Save Gallery</button>
        </div>
      </div>

      <div class="drag-hint">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12"><path d="M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l-3 3-3-3M19 9l3 3-3 3M2 12h20M12 2v20"/></svg>
        Drag cards to reorder
      </div>

      <div class="gallery-grid" id="galleryGrid"></div>

      <button class="btn btn-ghost" id="addPhotoBtn" style="gap:0.5rem;">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="15" height="15"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        Add Photo
      </button>
    </div>

    <!-- â”€â”€ PUBLISH â”€â”€ -->
    <div class="page" id="page-publish">
      <div class="page-header">
        <h1>Publish to Website</h1>
        <p>Push price &amp; gallery changes directly to GitHub â€” Vercel deploys automatically</p>
      </div>

      <div class="github-panel">
        <div class="github-panel-head">
          <svg viewBox="0 0 24 24" fill="white" width="18" height="18"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"/></svg>
          <div class="github-panel-head-title">GitHub Connection</div>
          <span class="github-panel-head-sub" id="ghConnStatus">Not configured</span>
        </div>
        <div class="github-panel-body">
          <div class="github-fields">
            <div class="github-field">
              <label class="f-label" for="ghUser">GitHub Username</label>
              <input class="f-input" type="text" id="ghUser" placeholder="beinguvaize" autocomplete="off" />
            </div>
            <div class="github-field">
              <label class="f-label" for="ghRepo">Repository Name</label>
              <input class="f-input" type="text" id="ghRepo" placeholder="budgethomes" autocomplete="off" />
            </div>
            <div class="github-field">
              <label class="f-label" for="ghBranch">Branch</label>
              <input class="f-input" type="text" id="ghBranch" placeholder="main" autocomplete="off" />
            </div>
            <div class="github-field">
              <label class="f-label" for="ghFile">File Path</label>
              <input class="f-input" type="text" id="ghFile" placeholder="index.html" autocomplete="off" />
            </div>
            <div class="github-field full">
              <label class="f-label" for="ghToken">Personal Access Token <span style="color:#bbb;font-size:0.62rem;font-weight:300;">(stored locally on this device only)</span></label>
              <div class="token-wrap">
                <input class="f-input" type="password" id="ghToken" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx" autocomplete="off" />
                <button class="token-toggle" id="tokenToggle" type="button" title="Show/hide token">ğŸ‘</button>
              </div>
            </div>
          </div>
          <div class="connection-test">
            <button class="btn btn-ghost" id="testConnBtn" style="font-size:0.7rem;padding:0.5rem 1rem;">Test Connection</button>
            <button class="btn btn-gold" id="ghSaveBtn" style="font-size:0.7rem;padding:0.5rem 1rem;">Save Settings</button>
            <span class="connection-result" id="connResult"></span>
          </div>
        </div>
      </div>

      <div class="publish-panel">
        <div class="publish-info">
          <div class="publish-title">Save &amp; Publish Live</div>
          <div class="publish-sub">Bakes prices into <strong>index.html</strong> â†’ pushes to GitHub â†’ Vercel deploys in ~15s</div>
          <div class="publish-result" id="publishResult"></div>
        </div>
        <button class="btn-publish" id="publishBtn">ğŸš€ Publish Now</button>
      </div>

      <div class="publish-log" id="publishLog"></div>
    </div>

    <!-- â”€â”€ SETTINGS â”€â”€ -->
    <div class="page" id="page-settings">
      <div class="page-header">
        <h1>Settings</h1>
        <p>Manage your admin password and recovery key</p>
      </div>

      <div class="settings-section">
        <div class="panel">
          <div class="panel-title">Change Password</div>
          <label class="f-label" for="cpCurrent">Current Password</label>
          <input class="f-input" type="password" id="cpCurrent" placeholder="Enter current password" />
          <label class="f-label" for="cpNew">New Password</label>
          <input class="f-input" type="password" id="cpNew" placeholder="Min 6 characters" />
          <label class="f-label" for="cpConfirm">Confirm New Password</label>
          <input class="f-input" type="password" id="cpConfirm" placeholder="Re-enter new password" />
          <div class="f-error" id="cpErr"></div>
          <div style="margin-top:1rem;">
            <button class="btn btn-gold" id="cpSaveBtn">Update Password</button>
          </div>
        </div>

        <div class="alert alert-warn">
          <strong>âš  Recovery Key:</strong> A new recovery key is generated every time you change your password. It will be shown immediately after saving â€” copy it somewhere safe. Without it you cannot reset a forgotten password.
        </div>
      </div>
    </div>

  </main>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  MODALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- Edit/Add Photo modal -->
<div class="modal-backdrop" id="photoModal">
  <div class="modal wide">
    <div class="modal-title" id="photoModalTitle">Edit Photo</div>
    <div class="tabs-nav">
      <button class="tab-btn active" data-tab="upload">ğŸ“ Upload File</button>
      <button class="tab-btn" data-tab="url">ğŸ”— Paste URL</button>
    </div>
    <div class="tab-pane active" id="tab-upload">
      <div class="drop-zone" id="dropZone">
        <input type="file" id="fileInput" accept="image/*" />
        <div class="drop-zone-text">
          <strong>Click or drag &amp; drop an image</strong>
          JPG, PNG, WEBP â€” 800Ã—600px or larger recommended
        </div>
      </div>
      <img class="img-preview" id="uploadPreview" src="" alt="" />
    </div>
    <div class="tab-pane" id="tab-url">
      <label class="f-label" for="urlInput">Image URL</label>
      <input class="f-input" type="text" id="urlInput" placeholder="https://example.com/photo.jpg" />
      <img class="img-preview" id="urlPreview" src="" alt="" />
    </div>
    <label class="f-label" for="altInput" style="margin-top:1.25rem;">Caption / Alt Text</label>
    <input class="f-input" type="text" id="altInput" placeholder="e.g. Spacious guest bedroom" />
    <div class="f-error" id="photoErr"></div>
    <div class="modal-actions">
      <button class="btn btn-ghost" id="photoCancel">Cancel</button>
      <button class="btn btn-gold" id="photoApply">âœ¦ Apply Photo</button>
    </div>
  </div>
</div>

<!-- Recovery key modal -->
<div class="modal-backdrop" id="recoveryModal">
  <div class="modal">
    <div class="modal-title" id="recoveryModalTitle">ğŸ” Save Your Recovery Key</div>
    <p style="font-size:0.75rem;color:#888;line-height:1.7;">This key lets you reset your password if you ever forget it. <strong>Store it somewhere safe</strong> â€” it will not be shown again.</p>
    <div class="recovery-box" id="recoveryKeyDisplay"></div>
    <button class="btn btn-ghost" id="copyRecoveryBtn" style="width:100%;margin-bottom:0.75rem;">Copy Key</button>
    <button class="btn btn-gold" id="recoveryDoneBtn" style="width:100%;">âœ¦ I've saved it â€” Continue</button>
  </div>
</div>

<!-- Toast -->
<div id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
'use strict';
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STORAGE KEYS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const KEY_AUTH     = 'bh_auth_v2';
const KEY_PRICES   = 'bh_prices_v1';
const KEY_GALLERY  = 'bh_gallery_v1';
const KEY_GH       = 'bh_gh_v1';
const KEY_ACTIVITY = 'bh_activity_v1';
const KEY_LASTPUB  = 'bh_lastpub_v1';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEFAULT DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DEFAULT_PRICES = {
  unit1: { name:'Unit 1', type:'Studio Room',      price:1200, suffix:'/night' },
  unit2: { name:'Unit 2', type:'Standard Double',  price:1500, suffix:'/night' },
  unit3: { name:'Unit 3', type:'Deluxe Room',      price:1800, suffix:'/night' },
  unit4: { name:'Unit 4', type:'Triple Room',      price:2200, suffix:'/night' },
  unit5: { name:'Unit 5', type:'Family Suite',     price:2500, suffix:'/night' },
  pg:    { name:'PG',     type:'Paying Guest',     price:7000, suffix:'/month' },
  startingFrom: 1200,
  notes: ''
};

const DEFAULT_GALLERY = [
  { src:'https://lh3.googleusercontent.com/p/AF1QipNnbypKAq-OR87dILBwelmRJOE2N90kzKrIunbL=s0', alt:'Spacious guest bedroom' },
  { src:'https://lh3.googleusercontent.com/p/AF1QipMF3Rk7-43z_Mz-OPrT1uOwUEclgGI4jVCDPqHl=s0', alt:'Budget Homes exterior front view' },
  { src:'https://lh3.googleusercontent.com/p/AF1QipMJ--opG4jho3ivfTcc_ESvsOVB3g9SqMT0f1b6=s0', alt:'Kitchen and dining area' },
  { src:'https://lh3.googleusercontent.com/p/AF1QipMgkh2egTjMU3CCTrWsZ-WXpjmXnFKA5324GUyB=s0', alt:'Modern bathroom with amenities' },
  { src:'https://lh3.googleusercontent.com/p/AF1QipN8PDaZEbjXCN1sqepeeWe2gi_RjN77IGWy8dLi=s0', alt:'Interior common room' },
  { src:'https://lh3.googleusercontent.com/p/AF1QipNwWSFtIQVWES5v355o7i1OzONmkJFeuSajs05F=s0', alt:'Property exterior detail' },
  { src:'https://lh3.googleusercontent.com/p/AF1QipOtt4B6EYGffzpoMIK9gW3YoiaKjVXxGFElaKY4=s0', alt:'Entrance and parking area' },
  { src:'https://lh3.googleusercontent.com/p/AF1QipNtWdil7zQ72fPIISLDNCnGjgGl7XnCyDXtAvFF=s0', alt:'Room interior setup' },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const $ = id => document.getElementById(id);
const deep = o => JSON.parse(JSON.stringify(o));

function fmt(n) { return 'â‚¹' + Number(n).toLocaleString('en-IN'); }

function store(key, val) { try { localStorage.setItem(key, JSON.stringify(val)); } catch(e){} }
function load(key, def) {
  try { const r = localStorage.getItem(key); return r ? JSON.parse(r) : deep(def||null); }
  catch(e) { return deep(def||null); }
}

async function sha256(text) {
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(text));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

function genKey() {
  const s = () => Math.random().toString(36).slice(2,6).toUpperCase();
  return `${s()}-${s()}-${s()}`;
}

function toast(msg, type='') {
  const el = $('toast');
  el.textContent = msg;
  el.className = type ? `show ${type}` : 'show';
  clearTimeout(el._t);
  el._t = setTimeout(() => { el.className = ''; }, 3200);
}

function logActivity(msg, type='ok') {
  const acts = load(KEY_ACTIVITY, []);
  acts.unshift({ msg, type, time: new Date().toISOString() });
  if (acts.length > 20) acts.pop();
  store(KEY_ACTIVITY, acts);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function initAuth() {
  if (!load(KEY_AUTH)) {
    const key = genKey();
    store(KEY_AUTH, {
      hash: await sha256('budgethomes2026'),
      recoveryHash: await sha256(key)
    });
    showRecoveryModal(key, true);
  }
}

async function verifyPw(pw) {
  const a = load(KEY_AUTH);
  return a && (await sha256(pw)) === a.hash;
}

async function verifyRecovery(key) {
  const a = load(KEY_AUTH);
  return a && (await sha256(key.trim().toUpperCase())) === a.recoveryHash;
}

async function changePw(newPw) {
  const key = genKey();
  store(KEY_AUTH, {
    hash: await sha256(newPw),
    recoveryHash: await sha256(key)
  });
  return key;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOGIN FLOW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showLogin() {
  $('loginScreen').style.display = '';
  $('appShell').classList.remove('active');
}

function showApp() {
  $('loginScreen').style.display = 'none';
  $('appShell').classList.add('active');
  initApp();
}

// Login
$('loginBtn').addEventListener('click', async () => {
  const pw = $('pwInput').value;
  if (!pw) { $('loginErr').textContent = 'Please enter your password.'; return; }
  if (await verifyPw(pw)) {
    sessionStorage.setItem('bh_sess', '1');
    $('loginErr').textContent = '';
    showApp();
  } else {
    $('loginErr').textContent = 'Incorrect password.';
    $('pwInput').value = '';
    $('pwInput').focus();
  }
});
$('pwInput').addEventListener('keydown', e => { if(e.key==='Enter') $('loginBtn').click(); });

// Forgot
$('forgotBtn').addEventListener('click', () => {
  $('loginCard').style.display = 'none';
  $('resetCard').style.display = 'block';
  $('resetErr').textContent = '';
});
$('backLoginBtn').addEventListener('click', () => {
  $('resetCard').style.display = 'none';
  $('loginCard').style.display = '';
  $('loginErr').textContent = '';
});

// Do reset
$('doResetBtn').addEventListener('click', async () => {
  const key  = $('recoveryInput').value;
  const pw   = $('newPwReset').value;
  const conf = $('confirmPwReset').value;
  const err  = $('resetErr');

  if (!key)          { err.textContent = 'Enter your recovery key.'; return; }
  if (pw.length < 6) { err.textContent = 'Password must be at least 6 characters.'; return; }
  if (pw !== conf)   { err.textContent = 'Passwords do not match.'; return; }
  if (!await verifyRecovery(key)) { err.textContent = 'Recovery key is incorrect.'; return; }

  const newKey = await changePw(pw);
  err.textContent = '';
  ['recoveryInput','newPwReset','confirmPwReset'].forEach(id => $(id).value = '');
  $('resetCard').style.display = 'none';
  $('loginCard').style.display = '';
  showRecoveryModal(newKey, false);
  toast('Password reset successfully', 'ok');
});

// Logout
$('logoutBtn').addEventListener('click', () => {
  sessionStorage.removeItem('bh_sess');
  location.reload();
});

// Auto-login
(async () => {
  await initAuth();
  if (sessionStorage.getItem('bh_sess') === '1') showApp();
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function navTo(page) {
  document.querySelectorAll('.nav-item').forEach(i => i.classList.toggle('active', i.dataset.page === page));
  document.querySelectorAll('.page').forEach(p => p.classList.toggle('active', p.id === 'page-' + page));
  $('topbarBadge').textContent = page.charAt(0).toUpperCase() + page.slice(1);
  // Close sidebar on mobile
  if (window.innerWidth <= 768) $('sidebar').classList.remove('open');
}

document.querySelectorAll('.nav-item').forEach(item => {
  item.addEventListener('click', () => navTo(item.dataset.page));
});

$('sidebarToggle').addEventListener('click', () => $('sidebar').classList.toggle('open'));

// Close sidebar when clicking outside on mobile
document.addEventListener('click', e => {
  if (window.innerWidth <= 768 &&
      !$('sidebar').contains(e.target) &&
      !$('sidebarToggle').contains(e.target)) {
    $('sidebar').classList.remove('open');
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RECOVERY KEY MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showRecoveryModal(key, isFirst) {
  $('recoveryModalTitle').textContent = isFirst ? 'ğŸ” Welcome â€” Save Your Recovery Key' : 'ğŸ” New Recovery Key';
  $('recoveryKeyDisplay').textContent = key;
  $('recoveryModal').classList.add('open');
}

$('copyRecoveryBtn').addEventListener('click', () => {
  navigator.clipboard.writeText($('recoveryKeyDisplay').textContent).then(() => {
    $('copyRecoveryBtn').textContent = 'âœ“ Copied!';
    setTimeout(() => $('copyRecoveryBtn').textContent = 'Copy Key', 2000);
  });
});

$('recoveryDoneBtn').addEventListener('click', () => {
  $('recoveryModal').classList.remove('open');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHANGE PASSWORD (Settings page + topbar button)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
$('changePwTopBtn').addEventListener('click', () => navTo('settings'));

$('cpSaveBtn').addEventListener('click', async () => {
  const cur  = $('cpCurrent').value;
  const pw   = $('cpNew').value;
  const conf = $('cpConfirm').value;
  const err  = $('cpErr');

  if (!await verifyPw(cur))  { err.textContent = 'Current password is incorrect.'; return; }
  if (pw.length < 6)          { err.textContent = 'New password must be at least 6 characters.'; return; }
  if (pw !== conf)            { err.textContent = 'Passwords do not match.'; return; }
  if (pw === cur)             { err.textContent = 'New password must differ from current.'; return; }

  const newKey = await changePw(pw);
  err.textContent = '';
  ['cpCurrent','cpNew','cpConfirm'].forEach(id => $(id).value = '');
  showRecoveryModal(newKey, false);
  logActivity('Password changed');
  toast('Password updated successfully', 'ok');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// APP INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initApp() {
  renderDashboard();
  renderPrices();
  renderGallery();
  loadGhSettings();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDashboard() {
  const prices  = load(KEY_PRICES, DEFAULT_PRICES);
  const gallery = load(KEY_GALLERY, DEFAULT_GALLERY);
  const lastPub = load(KEY_LASTPUB);

  $('dash-lowest').innerHTML = `â‚¹<span>${Number(prices.startingFrom||prices.unit1?.price||1200).toLocaleString('en-IN')}</span>`;
  $('dash-pg').innerHTML     = `â‚¹<span>${Number(prices.pg?.price||7000).toLocaleString('en-IN')}</span>`;
  $('dash-photos').innerHTML = `<span>${Array.isArray(gallery)?gallery.length:8}</span>`;
  $('dash-publish').textContent = lastPub
    ? new Date(lastPub).toLocaleDateString('en-IN', {day:'numeric',month:'short',hour:'2-digit',minute:'2-digit'})
    : 'Never';

  const acts = load(KEY_ACTIVITY, []);
  const list = $('activityList');
  if (acts.length === 0) return;
  list.innerHTML = acts.slice(0,8).map(a => `
    <li class="activity-item">
      <span class="activity-dot ${a.type}"></span>
      <span>${a.msg}</span>
      <span class="activity-time">${new Date(a.time).toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit'})}</span>
    </li>
  `).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PRICES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let pricesDirty = false;

function renderPrices() {
  const prices = load(KEY_PRICES, DEFAULT_PRICES);
  const nightlyKeys = ['unit1','unit2','unit3','unit4','unit5'];
  const $ng = $('nightlyGrid');
  const $pg = $('pgGrid');
  $ng.innerHTML = '';
  $pg.innerHTML = '';

  nightlyKeys.forEach(k => $ng.appendChild(makePriceCard(k, prices[k] || DEFAULT_PRICES[k], false)));
  $pg.appendChild(makePriceCard('pg', prices.pg || DEFAULT_PRICES.pg, true));

  $('startingFrom').value = prices.startingFrom || DEFAULT_PRICES.startingFrom;
  $('adminNotes').value   = prices.notes || '';
  updateStartingPreview();

  // Dirty listeners
  document.querySelectorAll('.price-num').forEach(inp => inp.addEventListener('input', markPriceDirty));
  $('startingFrom').addEventListener('input', () => { markPriceDirty(); updateStartingPreview(); });
  $('adminNotes').addEventListener('input', markPriceDirty);
  setPriceStatus('clean');
}

function makePriceCard(key, data, isPg) {
  const card = document.createElement('div');
  card.className = 'price-card' + (isPg ? ' pg' : '');
  card.innerHTML = `
    <div class="price-card-badge">${data.name}</div>
    <div class="price-card-name">${data.type}</div>
    <div class="price-card-type">${data.suffix}</div>
    <div class="price-input-row">
      <span class="price-sym">â‚¹</span>
      <input class="price-num" type="number" id="inp_${key}" value="${data.price}" min="0" step="50" />
      <span class="price-suffix">${data.suffix}</span>
    </div>`;
  return card;
}

function updateStartingPreview() {
  const val = parseInt($('startingFrom').value, 10);
  $('startingFromPreview').textContent = isNaN(val) ? '' : fmt(val) + '/night';
}

function markPriceDirty() {
  pricesDirty = true;
  setPriceStatus('dirty');
}

function setPriceStatus(state) {
  const dot  = $('priceStatusDot');
  const text = $('priceStatusText');
  if (state === 'saved') { dot.className='status-dot saved'; text.textContent='All prices saved Â· ' + new Date().toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit'}); }
  else if (state === 'dirty') { dot.className='status-dot dirty'; text.textContent='Unsaved changes'; }
  else { dot.className='status-dot'; text.textContent='No unsaved changes'; }
}

function collectPrices() {
  const data = deep(DEFAULT_PRICES);
  ['unit1','unit2','unit3','unit4','unit5','pg'].forEach(k => {
    const inp = $('inp_' + k);
    if (inp) { data[k] = Object.assign({}, DEFAULT_PRICES[k], load(KEY_PRICES, DEFAULT_PRICES)[k] || {}, { price: parseInt(inp.value,10) || DEFAULT_PRICES[k].price }); }
  });
  data.startingFrom = parseInt($('startingFrom').value,10) || DEFAULT_PRICES.startingFrom;
  data.notes = $('adminNotes').value;
  return data;
}

$('priceSaveBtn').addEventListener('click', () => {
  const data = collectPrices();
  store(KEY_PRICES, data);
  pricesDirty = false;
  setPriceStatus('saved');
  logActivity('Prices updated');
  renderDashboard();
  toast('âœ¦ Prices saved', 'ok');
});

$('priceResetBtn').addEventListener('click', () => {
  if (!confirm('Reset all prices to original defaults?')) return;
  ['unit1','unit2','unit3','unit4','unit5','pg'].forEach(k => {
    const inp = $('inp_'+k);
    if (inp) inp.value = DEFAULT_PRICES[k].price;
  });
  $('startingFrom').value = DEFAULT_PRICES.startingFrom;
  $('adminNotes').value = '';
  updateStartingPreview();
  markPriceDirty();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GALLERY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let galleryPhotos = [];
let galleryDirty  = false;
let editingIdx    = -1;
let pendingSrc    = '';

function renderGallery() {
  galleryPhotos = load(KEY_GALLERY, DEFAULT_GALLERY);
  rebuildGalleryGrid();
  setGalleryStatus('clean');
}

function rebuildGalleryGrid() {
  const grid = $('galleryGrid');
  grid.innerHTML = '';
  galleryPhotos.forEach((photo, idx) => {
    const card = document.createElement('div');
    card.className = 'gallery-card';
    card.draggable = true;
    card.dataset.idx = idx;
    card.innerHTML = `
      <span class="gallery-card-num">Photo ${idx+1}</span>
      <button class="gallery-card-remove" data-idx="${idx}" title="Remove">âœ•</button>
      <div class="gallery-thumb">
        <img src="${photo.src}" alt="${photo.alt||''}" loading="lazy"
             onerror="this.style.opacity='0.3'" />
        <div class="gallery-thumb-overlay">âœ Edit</div>
      </div>
      <div class="gallery-card-body">
        <span class="gallery-alt-label">Caption</span>
        <input class="gallery-alt-input" type="text" value="${(photo.alt||'').replace(/"/g,'&quot;')}" placeholder="Captionâ€¦" data-idx="${idx}" />
      </div>`;
    grid.appendChild(card);
  });

  // Click thumb to edit
  grid.querySelectorAll('.gallery-thumb').forEach(t => {
    t.addEventListener('click', () => openPhotoModal(parseInt(t.closest('.gallery-card').dataset.idx)));
  });
  // Remove button
  grid.querySelectorAll('.gallery-card-remove').forEach(btn => {
    btn.addEventListener('click', e => { e.stopPropagation(); removePhoto(parseInt(btn.dataset.idx)); });
  });
  // Caption edit
  grid.querySelectorAll('.gallery-alt-input').forEach(inp => {
    inp.addEventListener('input', () => {
      galleryPhotos[parseInt(inp.dataset.idx)].alt = inp.value;
      markGalleryDirty();
    });
    inp.addEventListener('click', e => e.stopPropagation());
  });

  // Drag to reorder
  setupDrag(grid);
}

let dragSrc = null;
function setupDrag(grid) {
  grid.querySelectorAll('.gallery-card').forEach(card => {
    card.addEventListener('dragstart', () => { dragSrc = parseInt(card.dataset.idx); card.style.opacity='0.4'; });
    card.addEventListener('dragend',   () => { card.style.opacity=''; });
    card.addEventListener('dragover',  e => { e.preventDefault(); card.classList.add('drag-over'); });
    card.addEventListener('dragleave', () => card.classList.remove('drag-over'));
    card.addEventListener('drop', e => {
      e.preventDefault();
      card.classList.remove('drag-over');
      const to = parseInt(card.dataset.idx);
      if (dragSrc === null || dragSrc === to) return;
      const moved = galleryPhotos.splice(dragSrc, 1)[0];
      galleryPhotos.splice(to, 0, moved);
      dragSrc = null;
      rebuildGalleryGrid();
      markGalleryDirty();
    });
  });
}

function removePhoto(idx) {
  if (galleryPhotos.length <= 1) { toast('Must keep at least one photo', 'err'); return; }
  if (!confirm(`Remove Photo ${idx+1}?`)) return;
  galleryPhotos.splice(idx, 1);
  rebuildGalleryGrid();
  markGalleryDirty();
}

function markGalleryDirty() {
  galleryDirty = true;
  setGalleryStatus('dirty');
}

function setGalleryStatus(state) {
  const dot  = $('galleryStatusDot');
  const text = $('galleryStatusText');
  if (state==='saved') { dot.className='status-dot saved'; text.textContent='Gallery saved Â· '+new Date().toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit'}); }
  else if (state==='dirty') { dot.className='status-dot dirty'; text.textContent='Unsaved changes'; }
  else { dot.className='status-dot'; text.textContent='No unsaved changes'; }
}

$('gallerySaveBtn').addEventListener('click', () => {
  store(KEY_GALLERY, galleryPhotos);
  galleryDirty = false;
  setGalleryStatus('saved');
  logActivity(`Gallery saved (${galleryPhotos.length} photos)`);
  renderDashboard();
  toast('âœ¦ Gallery saved', 'ok');
});

$('galleryResetBtn').addEventListener('click', () => {
  if (!confirm('Reset gallery to original photos?')) return;
  galleryPhotos = deep(DEFAULT_GALLERY);
  rebuildGalleryGrid();
  markGalleryDirty();
});

$('addPhotoBtn').addEventListener('click', () => openPhotoModal(-1));

// â”€â”€ Photo edit modal â”€â”€
function openPhotoModal(idx) {
  editingIdx = idx;
  pendingSrc = '';
  const isNew = idx === -1;
  $('photoModalTitle').textContent = isNew ? 'Add New Photo' : `Edit Photo ${idx+1}`;
  $('altInput').value = isNew ? '' : (galleryPhotos[idx]?.alt || '');
  $('photoErr').textContent = '';
  $('urlInput').value = '';
  $('uploadPreview').classList.remove('show');
  $('urlPreview').classList.remove('show');
  $('fileInput').value = '';
  activateTab('upload');
  $('photoModal').classList.add('open');
}

$('photoCancel').addEventListener('click', () => $('photoModal').classList.remove('open'));
$('photoModal').addEventListener('click', e => { if(e.target === $('photoModal')) $('photoModal').classList.remove('open'); });
$('recoveryModal').addEventListener('click', e => { if(e.target === $('recoveryModal')) $('recoveryModal').classList.remove('open'); });

// Tabs
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', () => activateTab(btn.dataset.tab));
});
function activateTab(name) {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.dataset.tab===name));
  document.querySelectorAll('.tab-pane').forEach(p => p.classList.toggle('active', p.id==='tab-'+name));
  pendingSrc = '';
}

// File upload
$('fileInput').addEventListener('change', () => handleFile($('fileInput').files[0]));
$('dropZone').addEventListener('dragover', e => { e.preventDefault(); $('dropZone').classList.add('drag-over'); });
$('dropZone').addEventListener('dragleave', () => $('dropZone').classList.remove('drag-over'));
$('dropZone').addEventListener('drop', e => {
  e.preventDefault();
  $('dropZone').classList.remove('drag-over');
  handleFile(e.dataTransfer.files[0]);
});

function handleFile(file) {
  if (!file || !file.type.startsWith('image/')) { $('photoErr').textContent='Please select a valid image.'; return; }
  const reader = new FileReader();
  reader.onload = e => {
    pendingSrc = e.target.result;
    const prev = $('uploadPreview');
    prev.src = pendingSrc;
    prev.classList.add('show');
    $('photoErr').textContent = '';
  };
  reader.readAsDataURL(file);
}

// URL input
$('urlInput').addEventListener('input', function() {
  const val = this.value.trim();
  const prev = $('urlPreview');
  if (val.startsWith('http')) {
    prev.src = val;
    prev.onload  = () => { prev.classList.add('show'); pendingSrc = val; $('photoErr').textContent=''; };
    prev.onerror = () => { prev.classList.remove('show'); pendingSrc=''; $('photoErr').textContent='Cannot load image from this URL.'; };
  } else { prev.classList.remove('show'); pendingSrc=''; }
});

// Apply photo
$('photoApply').addEventListener('click', () => {
  if (!pendingSrc) { $('photoErr').textContent='Please upload a photo or enter a valid URL.'; return; }
  const alt = $('altInput').value.trim() || 'Budget Homes photo';
  if (editingIdx === -1) {
    galleryPhotos.push({ src: pendingSrc, alt });
  } else {
    galleryPhotos[editingIdx] = { src: pendingSrc, alt };
  }
  rebuildGalleryGrid();
  markGalleryDirty();
  $('photoModal').classList.remove('open');
  toast(editingIdx === -1 ? 'Photo added' : 'Photo updated', 'ok');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GITHUB SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function loadGhSettings() {
  const s = load(KEY_GH, { user:'beinguvaize', repo:'budgethomes', branch:'main', file:'index.html', token:'' });
  $('ghUser').value   = s.user   || '';
  $('ghRepo').value   = s.repo   || '';
  $('ghBranch').value = s.branch || 'main';
  $('ghFile').value   = s.file   || 'index.html';
  $('ghToken').value  = s.token  || '';
  updateGhStatus();
}

function getGhSettings() {
  return {
    user:   $('ghUser').value.trim(),
    repo:   $('ghRepo').value.trim(),
    branch: $('ghBranch').value.trim() || 'main',
    file:   $('ghFile').value.trim() || 'index.html',
    token:  $('ghToken').value.trim(),
  };
}

function updateGhStatus() {
  const s = getGhSettings();
  const ok = s.user && s.repo && s.token;
  $('ghConnStatus').textContent = ok ? `${s.user}/${s.repo}` : 'Not configured';
  $('ghConnStatus').style.color = ok ? '#6fcf97' : '#888';
}

$('ghSaveBtn').addEventListener('click', () => {
  store(KEY_GH, getGhSettings());
  updateGhStatus();
  toast('GitHub settings saved', 'ok');
  $('connResult').textContent = 'âœ“ Settings saved';
  $('connResult').className = 'connection-result ok';
  setTimeout(() => { $('connResult').textContent=''; $('connResult').className='connection-result'; }, 3000);
});

// Show/hide token
$('tokenToggle').addEventListener('click', () => {
  const inp = $('ghToken');
  inp.type = inp.type === 'password' ? 'text' : 'password';
  $('tokenToggle').textContent = inp.type === 'password' ? 'ğŸ‘' : 'ğŸ™ˆ';
});

// Test connection
$('testConnBtn').addEventListener('click', async () => {
  const s = getGhSettings();
  const res = $('connResult');
  if (!s.token || !s.user || !s.repo) { res.textContent='âš  Fill in all fields first.'; res.className='connection-result error'; return; }
  res.textContent = 'Testingâ€¦'; res.className = 'connection-result';
  try {
    const r = await fetch(`https://api.github.com/repos/${s.user}/${s.repo}`, {
      headers: { 'Authorization': `Bearer ${s.token}`, 'Accept': 'application/vnd.github+json' }
    });
    if (r.ok) {
      const d = await r.json();
      res.textContent = `âœ“ Connected â€” ${d.full_name}`;
      res.className = 'connection-result ok';
    } else {
      const d = await r.json();
      res.textContent = `âœ• ${d.message || 'Auth failed'}`;
      res.className = 'connection-result error';
    }
  } catch(e) {
    res.textContent = 'âœ• Network error';
    res.className = 'connection-result error';
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PUBLISH â€” Inject & Push to GitHub
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addLog(msg, type='') {
  const log = $('publishLog');
  log.classList.add('active');
  const line = document.createElement('span');
  line.className = 'log-line' + (type ? ' '+type : '');
  line.textContent = `[${new Date().toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit',second:'2-digit'})}] ${msg}`;
  log.appendChild(line);
  log.scrollTop = log.scrollHeight;
}

function injectPrices(html, prices) {
  const keys = ['unit1','unit2','unit3','unit4','unit5','pg'];
  let pos = 0;
  keys.forEach(key => {
    const p = prices[key];
    if (!p) return;
    const fmtd  = 'â‚¹' + Number(p.price).toLocaleString('en-IN');
    const sfx   = p.suffix || (key==='pg'?'/month':'/night');
    const marker = 'class="room-price">';
    const idx   = html.indexOf(marker, pos);
    if (idx === -1) return;
    const start  = idx + marker.length;
    const endTag = html.indexOf('</div>', start);
    if (endTag === -1) return;
    html = html.slice(0, start) + `${fmtd}<span>${sfx}</span>` + html.slice(endTag);
    pos  = start;
  });
  // Starting from â€” hero text
  if (prices.startingFrom) {
    const sf = 'â‚¹' + Number(prices.startingFrom).toLocaleString('en-IN');
    html = html.replace(/â‚¹[\d,]+\/night(?=\.)/g, sf + '/night');
    html = html.replace(/(<span class="amt">)â‚¹[\d,]+(<\/span>)/, `$1${sf}$2`);
  }
  return html;
}

function injectGallery(html, photos) {
  if (!Array.isArray(photos) || photos.length === 0) return html;
  let pos = 0;
  photos.forEach(photo => {
    const marker = 'class="gallery-item';
    const itemStart = html.indexOf(marker, pos);
    if (itemStart === -1) return;
    const imgStart  = html.indexOf('<img ', itemStart);
    if (imgStart === -1) return;
    const imgEnd    = html.indexOf('>', imgStart);
    if (imgEnd === -1) return;
    let tag = html.slice(imgStart, imgEnd + 1);
    tag = tag
      .replace(/src="[^"]*"/, `src="${photo.src}"`)
      .replace(/alt="[^"]*"/, `alt="${(photo.alt||'').replace(/"/g,'&quot;')}"`);
    html = html.slice(0, imgStart) + tag + html.slice(imgEnd + 1);
    pos  = imgStart + tag.length;
  });
  return html;
}

$('publishBtn').addEventListener('click', async () => {
  const btn     = $('publishBtn');
  const result  = $('publishResult');
  const s       = getGhSettings();
  const log     = $('publishLog');

  log.innerHTML = '';
  log.classList.remove('active');

  if (!s.token) {
    result.textContent = 'âš  Enter your GitHub token in the settings above first.';
    result.className = 'publish-result error';
    return;
  }
  if (!s.user || !s.repo) {
    result.textContent = 'âš  GitHub username and repository are required.';
    result.className = 'publish-result error';
    return;
  }

  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span> Publishingâ€¦';
  result.textContent = '';
  result.className = 'publish-result info';

  const apiUrl = `https://api.github.com/repos/${s.user}/${s.repo}/contents/${s.file}`;
  const headers = {
    'Authorization': `Bearer ${s.token}`,
    'Accept': 'application/vnd.github+json',
    'X-GitHub-Api-Version': '2022-11-28',
  };

  try {
    addLog(`Fetching ${s.file} from ${s.user}/${s.repo}â€¦`);
    const getRes = await fetch(`${apiUrl}?ref=${s.branch}`, { headers });
    if (!getRes.ok) {
      const e = await getRes.json();
      throw new Error(e.message || `HTTP ${getRes.status}`);
    }
    const fileData = await getRes.json();
    addLog('File fetched successfully.', 'ok');

    addLog('Injecting updated pricesâ€¦');
    let content = decodeURIComponent(escape(atob(fileData.content.replace(/\n/g,''))));
    const prices  = load(KEY_PRICES, DEFAULT_PRICES);
    const gallery = load(KEY_GALLERY, DEFAULT_GALLERY);
    content = injectPrices(content, prices);
    addLog('Prices injected.', 'ok');

    addLog('Injecting gallery photosâ€¦');
    content = injectGallery(content, gallery);
    addLog('Gallery injected.', 'ok');

    addLog('Pushing to GitHubâ€¦');
    const now = new Date().toLocaleString('en-IN', { timeZone:'Asia/Kolkata', day:'numeric', month:'short', hour:'2-digit', minute:'2-digit' });
    const putRes = await fetch(apiUrl, {
      method: 'PUT',
      headers: { ...headers, 'Content-Type': 'application/json' },
      body: JSON.stringify({
        message: `Admin: update prices & gallery â€” ${now} IST`,
        content: btoa(unescape(encodeURIComponent(content))),
        sha: fileData.sha,
        branch: s.branch,
      })
    });

    if (!putRes.ok) {
      const e = await putRes.json();
      throw new Error(e.message || `Push failed HTTP ${putRes.status}`);
    }

    addLog('Pushed to GitHub successfully!', 'ok');
    addLog('Vercel is deployingâ€¦ live in ~15 seconds.', 'ok');

    const now2 = new Date().toISOString();
    store(KEY_LASTPUB, now2);
    logActivity('Published to GitHub â†’ Vercel');
    renderDashboard();

    result.textContent = 'âœ“ Live! Vercel deploying â€” check your site in ~15 seconds.';
    result.className = 'publish-result ok';
    toast('ğŸš€ Published successfully!', 'ok');

  } catch(err) {
    addLog('Error: ' + err.message, 'err');
    result.textContent = 'âœ• ' + err.message;
    result.className = 'publish-result error';
    toast('Publish failed: ' + err.message, 'err');
  } finally {
    btn.disabled = false;
    btn.textContent = 'ğŸš€ Publish Now';
  }
});
</script>
</body>
</html>
