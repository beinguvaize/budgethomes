<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin · Budget Homes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    :root {
      --ink: #0d0d0d;
      --paper: #f5f2eb;
      --gold: #b8942a;
      --gold-light: #d4a93a;
      --gold-pale: #f5edda;
      --rule: #d6cdb8;
      --success: #2d6a4f;
      --success-bg: #d8f3dc;
      --error: #9b2226;
      --error-bg: #fde8e8;
      --mono: 'DM Mono', monospace;
      --serif: 'Cormorant Garamond', Georgia, serif;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: var(--mono);
      background: var(--paper);
      color: var(--ink);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ── Login Screen ── */
    #loginScreen {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      background:
        repeating-linear-gradient(0deg, transparent, transparent 39px, var(--rule) 39px, var(--rule) 40px),
        repeating-linear-gradient(90deg, transparent, transparent 39px, var(--rule) 40px, var(--rule) 41px);
    }

    .login-card {
      background: white;
      border: 1.5px solid var(--ink);
      padding: 3rem 2.5rem;
      width: 100%;
      max-width: 380px;
      box-shadow: 6px 6px 0 var(--ink);
      position: relative;
    }

    .login-card::before {
      content: 'RESTRICTED';
      position: absolute;
      top: -12px;
      left: 20px;
      background: var(--gold);
      color: white;
      font-size: 0.6rem;
      font-weight: 500;
      letter-spacing: 0.15em;
      padding: 2px 10px;
    }

    .login-logo {
      font-family: var(--serif);
      font-size: 2rem;
      font-weight: 600;
      letter-spacing: 0.02em;
      margin-bottom: 0.25rem;
    }
    .login-logo span { color: var(--gold); }

    .login-sub {
      font-size: 0.72rem;
      letter-spacing: 0.08em;
      color: #777;
      margin-bottom: 2rem;
      text-transform: uppercase;
    }

    .field-label {
      display: block;
      font-size: 0.68rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #555;
      margin-bottom: 0.4rem;
    }

    input[type="password"] {
      width: 100%;
      border: 1.5px solid var(--ink);
      background: var(--paper);
      font-family: var(--mono);
      font-size: 0.9rem;
      padding: 0.65rem 0.9rem;
      outline: none;
      transition: border-color 0.15s;
      letter-spacing: 0.1em;
    }
    input[type="password"]:focus { border-color: var(--gold); background: white; }

    .login-err {
      font-size: 0.72rem;
      color: var(--error);
      margin-top: 0.5rem;
      min-height: 1.2em;
    }

    .btn-login {
      display: block;
      width: 100%;
      margin-top: 1.5rem;
      background: var(--ink);
      color: white;
      border: none;
      font-family: var(--mono);
      font-size: 0.78rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      padding: 0.75rem;
      cursor: pointer;
      transition: background 0.15s, transform 0.1s;
    }
    .btn-login:hover { background: var(--gold); }
    .btn-login:active { transform: scale(0.98); }

    /* ── Admin Panel ── */
    #adminPanel { display: none; flex: 1; flex-direction: column; }
    #adminPanel.active { display: flex; }

    header.admin-header {
      background: var(--ink);
      color: white;
      padding: 0 2rem;
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-brand {
      font-family: var(--serif);
      font-size: 1.25rem;
      font-weight: 600;
    }
    .header-brand span { color: var(--gold-light); }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .header-tag {
      font-size: 0.65rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: #aaa;
    }

    .btn-logout {
      background: transparent;
      border: 1px solid #555;
      color: #bbb;
      font-family: var(--mono);
      font-size: 0.68rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      padding: 0.35rem 0.9rem;
      cursor: pointer;
      transition: border-color 0.15s, color 0.15s;
    }
    .btn-logout:hover { border-color: var(--gold); color: var(--gold-light); }

    .admin-body {
      flex: 1;
      padding: 2.5rem 2rem;
      max-width: 820px;
      margin: 0 auto;
      width: 100%;
    }

    .page-title {
      font-family: var(--serif);
      font-size: 2.2rem;
      font-weight: 400;
      font-style: italic;
      color: var(--ink);
      margin-bottom: 0.25rem;
    }
    .page-desc {
      font-size: 0.72rem;
      color: #777;
      letter-spacing: 0.06em;
      margin-bottom: 2.5rem;
    }

    /* ── Toast ── */
    #saveToast {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%) translateY(80px);
      background: var(--ink);
      color: white;
      font-size: 0.78rem;
      letter-spacing: 0.08em;
      padding: 0.75rem 1.5rem;
      border-left: 3px solid var(--gold);
      box-shadow: 4px 4px 0 var(--gold);
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      white-space: nowrap;
      z-index: 999;
    }
    #saveToast.show { transform: translateX(-50%) translateY(0); }

    /* ── Price Cards ── */
    .section-rule {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.25rem;
    }
    .section-rule-label {
      font-size: 0.65rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--gold);
      white-space: nowrap;
    }
    .section-rule-line {
      flex: 1;
      height: 1px;
      background: var(--rule);
    }

    .price-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 1rem;
      margin-bottom: 2.5rem;
    }

    .price-card {
      border: 1.5px solid var(--rule);
      background: white;
      padding: 1.4rem 1.25rem 1.25rem;
      position: relative;
      transition: border-color 0.15s, box-shadow 0.15s;
    }
    .price-card:hover {
      border-color: var(--gold);
      box-shadow: 3px 3px 0 var(--gold-pale);
    }
    .price-card.pg-card {
      border-color: var(--gold);
      background: var(--gold-pale);
    }

    .card-badge {
      position: absolute;
      top: -1px;
      left: 1rem;
      transform: translateY(-50%);
      background: var(--ink);
      color: white;
      font-size: 0.6rem;
      font-weight: 500;
      letter-spacing: 0.14em;
      padding: 2px 8px;
    }
    .pg-card .card-badge { background: var(--gold); }

    .card-name {
      font-family: var(--serif);
      font-size: 1.05rem;
      font-weight: 600;
      margin-top: 0.5rem;
      margin-bottom: 0.2rem;
    }
    .card-type {
      font-size: 0.65rem;
      letter-spacing: 0.1em;
      color: #888;
      text-transform: uppercase;
      margin-bottom: 1rem;
    }

    .price-input-wrap {
      display: flex;
      align-items: center;
      border: 1.5px solid var(--ink);
      background: var(--paper);
      overflow: hidden;
      transition: border-color 0.15s;
    }
    .price-input-wrap:focus-within { border-color: var(--gold); background: white; }

    .currency-sym {
      padding: 0 0.6rem;
      font-family: var(--serif);
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--gold);
      border-right: 1px solid var(--rule);
      user-select: none;
    }

    input[type="number"] {
      flex: 1;
      border: none;
      background: transparent;
      font-family: var(--mono);
      font-size: 1.05rem;
      font-weight: 500;
      padding: 0.55rem 0.7rem;
      outline: none;
      color: var(--ink);
      -moz-appearance: textfield;
    }
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; }

    .price-unit {
      padding: 0 0.6rem;
      font-size: 0.62rem;
      letter-spacing: 0.08em;
      color: #999;
      border-left: 1px solid var(--rule);
      white-space: nowrap;
      user-select: none;
    }

    /* ── Notes section ── */
    .notes-box {
      border: 1.5px solid var(--rule);
      background: white;
      padding: 1.5rem;
      margin-bottom: 2.5rem;
    }
    .notes-title {
      font-size: 0.65rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: 0.75rem;
    }
    .notes-box textarea {
      width: 100%;
      border: 1.5px solid var(--rule);
      background: var(--paper);
      font-family: var(--mono);
      font-size: 0.8rem;
      padding: 0.65rem 0.9rem;
      resize: vertical;
      min-height: 80px;
      outline: none;
      color: var(--ink);
      line-height: 1.5;
      transition: border-color 0.15s;
    }
    .notes-box textarea:focus { border-color: var(--gold); background: white; }

    /* ── Save Bar ── */
    .save-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      padding: 1rem 1.5rem;
      background: white;
      border: 1.5px solid var(--rule);
      margin-bottom: 2rem;
    }

    .save-info {
      font-size: 0.68rem;
      color: #888;
      letter-spacing: 0.05em;
    }
    .save-info strong { color: var(--ink); }

    .btn-save {
      background: var(--gold);
      color: white;
      border: none;
      font-family: var(--mono);
      font-size: 0.78rem;
      font-weight: 500;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      padding: 0.7rem 2rem;
      cursor: pointer;
      transition: background 0.15s, transform 0.1s, box-shadow 0.15s;
    }
    .btn-save:hover {
      background: #9a7a1e;
      box-shadow: 3px 3px 0 var(--ink);
    }
    .btn-save:active { transform: scale(0.97); }

    .btn-reset {
      background: transparent;
      border: 1.5px solid var(--rule);
      color: #888;
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      padding: 0.7rem 1.25rem;
      cursor: pointer;
      transition: border-color 0.15s, color 0.15s;
    }
    .btn-reset:hover { border-color: var(--error); color: var(--error); }

    /* ── Status indicator ── */
    .status-dot {
      display: inline-block;
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #ccc;
      margin-right: 5px;
      vertical-align: middle;
    }
    .status-dot.saved { background: var(--success); }

    /* ── Preview pane ── */
    .preview-box {
      border: 1.5px dashed var(--rule);
      padding: 1.5rem;
      background: #fafafa;
      margin-bottom: 3rem;
    }
    .preview-title {
      font-size: 0.65rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: #aaa;
      margin-bottom: 1rem;
    }
    .preview-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem 1.5rem;
    }
    .preview-item {
      font-size: 0.78rem;
      color: #555;
    }
    .preview-item strong {
      color: var(--ink);
      font-weight: 500;
    }
    .preview-price {
      color: var(--gold);
      font-weight: 500;
    }

    /* ── Instructions ── */
    .howto {
      border-top: 1px solid var(--rule);
      padding-top: 1.5rem;
      margin-bottom: 3rem;
    }
    .howto-title {
      font-family: var(--serif);
      font-size: 1.1rem;
      font-style: italic;
      margin-bottom: 0.75rem;
    }
    .howto p {
      font-size: 0.75rem;
      line-height: 1.7;
      color: #666;
      margin-bottom: 0.5rem;
    }
    .howto code {
      background: var(--paper);
      border: 1px solid var(--rule);
      padding: 1px 6px;
      font-family: var(--mono);
      font-size: 0.72rem;
    }

    /* responsive */
    @media (max-width: 480px) {
      .admin-body { padding: 1.5rem 1rem; }
      .price-grid { grid-template-columns: 1fr 1fr; }
      .save-bar { flex-direction: column; align-items: stretch; }
      .header-tag { display: none; }
    }
  </style>
</head>
<body>

<!-- ══════════════ LOGIN ══════════════ -->
<div id="loginScreen">
  <div class="login-card">
    <div class="login-logo">Budget <span>Homes</span></div>
    <div class="login-sub">Admin · Price Manager</div>
    <label class="field-label" for="pwInput">Password</label>
    <input type="password" id="pwInput" placeholder="Enter admin password" autocomplete="current-password" />
    <div class="login-err" id="loginErr"></div>
    <button class="btn-login" id="loginBtn">Unlock Panel</button>
  </div>
</div>

<!-- ══════════════ ADMIN PANEL ══════════════ -->
<div id="adminPanel">
  <header class="admin-header">
    <div class="header-brand">Budget <span>Homes</span></div>
    <div class="header-actions">
      <span class="header-tag">Price Manager</span>
      <button class="btn-logout" id="logoutBtn">Log out</button>
    </div>
  </header>

  <main class="admin-body">
    <h1 class="page-title">Manage Prices</h1>
    <p class="page-desc">Update room &amp; PG pricing. Changes apply to the website automatically.</p>

    <!-- Nightly Rates -->
    <div class="section-rule">
      <span class="section-rule-label">Nightly Rates</span>
      <div class="section-rule-line"></div>
    </div>

    <div class="price-grid" id="nightlyGrid">
      <!-- Cards injected by JS -->
    </div>

    <!-- PG Rate -->
    <div class="section-rule">
      <span class="section-rule-label">Paying Guest Rate</span>
      <div class="section-rule-line"></div>
    </div>

    <div class="price-grid" id="pgGrid"></div>

    <!-- Starting From note (hero/booking section) -->
    <div class="section-rule">
      <span class="section-rule-label">Website Display</span>
      <div class="section-rule-line"></div>
    </div>

    <div class="notes-box">
      <div class="notes-title">Hero &amp; Booking Section — "Starting From" Price</div>
      <p style="font-size:0.72rem;color:#888;margin-bottom:0.75rem;">
        This price appears in the hero text and "Book Directly &amp; Save" section. Usually set to your lowest nightly rate.
      </p>
      <div class="price-input-wrap" style="max-width:240px;">
        <span class="currency-sym">₹</span>
        <input type="number" id="startingFrom" min="100" step="50" />
        <span class="price-unit">/ night · from</span>
      </div>
    </div>

    <!-- Admin notes -->
    <div class="notes-box">
      <div class="notes-title">Private Admin Notes</div>
      <textarea id="adminNotes" placeholder="e.g. Peak season pricing active until Jan 31…"></textarea>
    </div>

    <!-- Save bar -->
    <div class="save-bar">
      <div class="save-info">
        <span class="status-dot" id="statusDot"></span>
        <span id="saveStatus">No unsaved changes</span>
      </div>
      <div style="display:flex;gap:0.75rem;align-items:center;">
        <button class="btn-reset" id="resetBtn">Reset to Defaults</button>
        <button class="btn-save" id="saveBtn">✦ Save All Prices</button>
      </div>
    </div>

    <!-- Live preview -->
    <div class="section-rule">
      <span class="section-rule-label">Live Preview</span>
      <div class="section-rule-line"></div>
    </div>
    <div class="preview-box">
      <div class="preview-title">Current saved prices (as shown on website)</div>
      <div class="preview-list" id="previewList"></div>
    </div>

    <!-- Instructions -->
    <div class="howto">
      <div class="howto-title">How this works</div>
      <p>Prices you save here are stored in your browser's local storage and applied to <code>index.html</code> automatically when <code>prices.js</code> is included in the page.</p>
      <p>To activate live price injection on your website, add this line just before the closing <code>&lt;/body&gt;</code> tag in <code>index.html</code>:</p>
      <p><code>&lt;script src="prices.js"&gt;&lt;/script&gt;</code></p>
      <p>Both <code>admin.html</code> and <code>index.html</code> must be on the same domain for the prices to carry over.</p>
    </div>

  </main>
</div>

<!-- Toast -->
<div id="saveToast">✦ Prices saved successfully</div>

<script>
  // ── Config ──────────────────────────────────────────────
  const ADMIN_PASSWORD = 'budgethomes2026'; // ← Change this password!
  const STORAGE_KEY = 'bh_prices_v1';

  const DEFAULTS = {
    unit1: { name: 'Unit 1', type: 'Studio Room',       price: 1200, unit: '/night' },
    unit2: { name: 'Unit 2', type: 'Standard Double',   price: 1500, unit: '/night' },
    unit3: { name: 'Unit 3', type: 'Deluxe Room',       price: 1800, unit: '/night' },
    unit4: { name: 'Unit 4', type: 'Triple Room',       price: 2200, unit: '/night' },
    unit5: { name: 'Unit 5', type: 'Family Suite',      price: 2500, unit: '/night' },
    pg:    { name: 'PG',     type: 'Paying Guest',      price: 7000, unit: '/month' },
    startingFrom: 1200,
    notes: ''
  };

  // ── State ────────────────────────────────────────────────
  let saved = loadSaved();
  let dirty = false;

  function loadSaved() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : JSON.parse(JSON.stringify(DEFAULTS));
    } catch { return JSON.parse(JSON.stringify(DEFAULTS)); }
  }

  // ── Login ────────────────────────────────────────────────
  const loginScreen = document.getElementById('loginScreen');
  const adminPanel  = document.getElementById('adminPanel');
  const pwInput     = document.getElementById('pwInput');
  const loginErr    = document.getElementById('loginErr');
  const loginBtn    = document.getElementById('loginBtn');

  // Auto-login if session active
  if (sessionStorage.getItem('bh_admin_auth') === '1') showPanel();

  loginBtn.addEventListener('click', attemptLogin);
  pwInput.addEventListener('keydown', e => { if (e.key === 'Enter') attemptLogin(); });

  function attemptLogin() {
    if (pwInput.value === ADMIN_PASSWORD) {
      loginErr.textContent = '';
      sessionStorage.setItem('bh_admin_auth', '1');
      showPanel();
    } else {
      loginErr.textContent = 'Incorrect password. Try again.';
      pwInput.value = '';
      pwInput.focus();
    }
  }

  function showPanel() {
    loginScreen.style.display = 'none';
    adminPanel.classList.add('active');
    renderCards();
    renderPreview();
  }

  document.getElementById('logoutBtn').addEventListener('click', () => {
    sessionStorage.removeItem('bh_admin_auth');
    location.reload();
  });

  // ── Render price cards ───────────────────────────────────
  function renderCards() {
    const nightlyKeys = ['unit1','unit2','unit3','unit4','unit5'];
    const nightlyGrid = document.getElementById('nightlyGrid');
    const pgGrid      = document.getElementById('pgGrid');

    nightlyKeys.forEach(k => {
      nightlyGrid.appendChild(makeCard(k, false));
    });
    pgGrid.appendChild(makeCard('pg', true));

    // Starting from
    document.getElementById('startingFrom').value = saved.startingFrom || DEFAULTS.startingFrom;
    document.getElementById('adminNotes').value   = saved.notes || '';

    // Change listeners for dirty tracking
    nightlyGrid.querySelectorAll('input').forEach(inp => inp.addEventListener('input', markDirty));
    pgGrid.querySelectorAll('input').forEach(inp => inp.addEventListener('input', markDirty));
    document.getElementById('startingFrom').addEventListener('input', markDirty);
    document.getElementById('adminNotes').addEventListener('input', markDirty);
  }

  function makeCard(key, isPg) {
    const def   = DEFAULTS[key];
    const price = (saved[key] && saved[key].price) || def.price;

    const card = document.createElement('div');
    card.className = 'price-card' + (isPg ? ' pg-card' : '');
    card.innerHTML = `
      <div class="card-badge">${def.name}</div>
      <div class="card-name">${def.type}</div>
      <div class="card-type">${def.unit.trim()}</div>
      <div class="price-input-wrap">
        <span class="currency-sym">₹</span>
        <input type="number" id="inp_${key}" value="${price}" min="0" step="50" />
        <span class="price-unit">${def.unit}</span>
      </div>
    `;
    return card;
  }

  // ── Dirty tracking ───────────────────────────────────────
  function markDirty() {
    dirty = true;
    document.getElementById('saveStatus').textContent = 'You have unsaved changes';
    document.getElementById('statusDot').classList.remove('saved');
  }

  // ── Save ─────────────────────────────────────────────────
  document.getElementById('saveBtn').addEventListener('click', saveAll);

  function saveAll() {
    const data = JSON.parse(JSON.stringify(DEFAULTS));

    ['unit1','unit2','unit3','unit4','unit5','pg'].forEach(k => {
      const inp = document.getElementById('inp_' + k);
      if (inp) data[k].price = parseInt(inp.value, 10) || DEFAULTS[k].price;
    });

    data.startingFrom = parseInt(document.getElementById('startingFrom').value, 10) || DEFAULTS.startingFrom;
    data.notes        = document.getElementById('adminNotes').value;

    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    saved = data;
    dirty = false;

    document.getElementById('saveStatus').textContent = 'All prices saved · ' + new Date().toLocaleTimeString();
    document.getElementById('statusDot').classList.add('saved');

    const toast = document.getElementById('saveToast');
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 2800);

    renderPreview();
  }

  // ── Reset ────────────────────────────────────────────────
  document.getElementById('resetBtn').addEventListener('click', () => {
    if (!confirm('Reset all prices to original defaults?')) return;
    ['unit1','unit2','unit3','unit4','unit5','pg'].forEach(k => {
      const inp = document.getElementById('inp_' + k);
      if (inp) inp.value = DEFAULTS[k].price;
    });
    document.getElementById('startingFrom').value = DEFAULTS.startingFrom;
    document.getElementById('adminNotes').value   = '';
    markDirty();
  });

  // ── Preview ──────────────────────────────────────────────
  function renderPreview() {
    const list = document.getElementById('previewList');
    list.innerHTML = '';
    const allKeys = ['unit1','unit2','unit3','unit4','unit5','pg'];
    allKeys.forEach(k => {
      const d = saved[k] || DEFAULTS[k];
      const el = document.createElement('div');
      el.className = 'preview-item';
      el.innerHTML = `<strong>${d.name} ${d.type}:</strong> <span class="preview-price">₹${d.price.toLocaleString('en-IN')}${d.unit}</span>`;
      list.appendChild(el);
    });
    // Starting from
    const sf = document.createElement('div');
    sf.className = 'preview-item';
    sf.innerHTML = `<strong>Starting from:</strong> <span class="preview-price">₹${(saved.startingFrom || DEFAULTS.startingFrom).toLocaleString('en-IN')}/night</span>`;
    list.appendChild(sf);
  }
</script>
</body>
</html>
